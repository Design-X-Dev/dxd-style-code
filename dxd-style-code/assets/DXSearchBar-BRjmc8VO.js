import{r as x,c as L,s as ee,h as te,w as ae,a as r,o as n,j as m,e as c,A as V,B as $,x as z,T as le,b as H,d as S,p as f,y as h,z as v,q as M,F as C,G as B,H as se,P as ne}from"./vue.esm-bundler-C1fUoNF-.js";import{_ as oe}from"./DXInput-BG2R0LGs.js";import{_ as N}from"./DXIcon-Bc0cQL8C.js";import{_ as re}from"./DXLoader-DAWlORDv.js";import{_ as y}from"./DXText-Bu-Qlv6N.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as ie}from"./XMarkIcon-DTqRFgaM.js";import{r as de}from"./MagnifyingGlassIcon-DKNfedfR.js";import{r as ce}from"./ClockIcon-Dxvdr19S.js";const me=["data-size","data-loading"],fe={class:"flex items-center gap-1"},he={key:0,class:"p-2"},ye=["onClick","onMouseenter"],ge={key:1,class:"p-2"},pe=["onClick","onMouseenter"],ve={key:2,class:"p-2 border-t border-slate-200"},be=["onUpdate:modelValue"],we=["value"],T={__name:"DXSearchBar",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Поиск..."},label:{type:String,default:""},helper:{type:String,default:""},error:{type:String,default:""},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:String,default:"md"},suggestions:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},hotkey:{type:String,default:null},showHistory:{type:Boolean,default:!1},historyItems:{type:Array,default:()=>[]},filters:{type:Array,default:()=>[]},debounce:{type:Number,default:300},clearable:{type:Boolean,default:!0},dropdownWidth:{type:String,default:"auto"}},emits:["update:modelValue","search","select-suggestion","filter-change","clear"],setup(t,{emit:X}){const l=t,u=X,i=x(!1),d=x(-1),g=x(-1),b=x({});let w=null;const q=L(()=>{const e={sm:"w-64",md:"w-80",lg:"w-96",xl:"w-[28rem]",auto:"w-full"};return e[l.dropdownWidth]||e.auto}),F=L(()=>{if(!l.hotkey)return"";const e=l.hotkey.toLowerCase().split("+"),o=e.slice(0,-1),s=e[e.length-1].toUpperCase(),a={ctrl:"Ctrl",cmd:"⌘",meta:"⌘",alt:"Alt",shift:"Shift"};return[...o.map(k=>a[k]||k),s].join("+")});function U(e){u("update:modelValue",e),i.value=!0,w&&clearTimeout(w),w=setTimeout(()=>{e.trim()&&u("search",e)},l.debounce)}function A(){i.value=!0}function j(){setTimeout(()=>{i.value=!1},200)}function P(){d.value>=0&&l.suggestions[d.value]?D(l.suggestions[d.value]):l.modelValue.trim()&&u("search",l.modelValue)}function W(){i.value=!1}function G(){l.suggestions.length>0?d.value=Math.min(d.value+1,l.suggestions.length-1):l.historyItems.length>0&&(g.value=Math.min(g.value+1,l.historyItems.length-1))}function O(){l.suggestions.length>0?d.value=Math.max(d.value-1,-1):l.historyItems.length>0&&(g.value=Math.max(g.value-1,-1))}function D(e){u("update:modelValue",e.title),u("select-suggestion",e),i.value=!1}function J(e){u("update:modelValue",e),u("search",e),i.value=!1}function Q(){u("filter-change",{...b.value})}function R(){u("update:modelValue",""),u("clear"),i.value=!1}function E(e){if(!l.hotkey)return;const o=l.hotkey.toLowerCase().split("+"),s=o[o.length-1].toLowerCase(),a=o.slice(0,-1),p=e.key.toLowerCase()===s,k=a.includes("ctrl")?e.ctrlKey:!e.ctrlKey,Y=a.includes("cmd")||a.includes("meta")?e.metaKey:!e.metaKey,Z=a.includes("alt")?e.altKey:!e.altKey,_=a.includes("shift")?e.shiftKey:!e.shiftKey;if(p&&k&&Y&&Z&&_){e.preventDefault();const K=document.querySelector('[data-component="DXSearchBar"] input');K&&K.focus()}}function I(e){rootElement.value&&!rootElement.value.contains(e.target)&&(i.value=!1)}return ee(()=>{l.hotkey&&document.addEventListener("keydown",E),document.addEventListener("click",I)}),te(()=>{l.hotkey&&document.removeEventListener("keydown",E),document.removeEventListener("click",I),w&&clearTimeout(w)}),ae(()=>l.filters,e=>{e&&e.length>0&&e.forEach(o=>{b.value[o.id]||(b.value[o.id]=o.options[0]||"")})},{immediate:!0}),(e,o)=>(n(),r("div",{ref:"rootElement",class:"relative w-full","data-component":"DXSearchBar","data-size":t.size,"data-loading":t.loading},[m(oe,{"model-value":t.modelValue,placeholder:t.placeholder,disabled:t.disabled,size:t.size,error:t.error,helper:t.helper,label:t.label,required:t.required,"prefix-icon":z(de),"onUpdate:modelValue":U,onFocus:A,onBlur:j,onKeydown:[V(P,["enter"]),V(W,["escape"]),V($(G,["prevent"]),["down"]),V($(O,["prevent"]),["up"])]},{suffix:c(()=>[H("div",fe,[t.loading?(n(),S(re,{key:0,size:"sm"})):t.modelValue&&t.clearable?(n(),S(N,{key:1,icon:z(ie),size:"sm",class:"cursor-pointer text-slate-400 hover:text-slate-600",onClick:R},null,8,["icon"])):f("",!0),t.hotkey&&!t.modelValue?(n(),S(y,{key:2,tag:"span",size:"xs",color:"muted",class:"border border-slate-200 rounded px-1.5 py-0.5"},{default:c(()=>[h(v(F.value),1)]),_:1})):f("",!0)])]),_:1},8,["model-value","placeholder","disabled","size","error","helper","label","required","prefix-icon","onKeydown"]),m(le,{name:"fade"},{default:c(()=>[i.value&&(t.suggestions.length>0||t.showHistory&&t.historyItems.length>0||t.filters.length>0)?(n(),r("div",{key:0,class:M(["absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-xl shadow-lg max-h-96 overflow-y-auto",q.value])},[t.showHistory&&t.historyItems.length>0&&!t.modelValue?(n(),r("div",he,[m(y,{tag:"div",size:"xs",weight:"semibold",color:"muted",class:"px-2 py-1 uppercase"},{default:c(()=>[...o[0]||(o[0]=[h(" История поиска ",-1)])]),_:1}),(n(!0),r(C,null,B(t.historyItems,(s,a)=>(n(),r("div",{key:a,class:M(["px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded cursor-pointer flex items-center justify-between",{"bg-slate-50":g.value===a}]),onClick:p=>J(s),onMouseenter:p=>g.value=a},[m(y,{tag:"span"},{default:c(()=>[h(v(s),1)]),_:2},1024),m(N,{icon:z(ce),size:"xs",class:"text-slate-400"},null,8,["icon"])],42,ye))),128))])):f("",!0),t.suggestions&&t.suggestions.length>0?(n(),r("div",ge,[(n(!0),r(C,null,B(t.suggestions,(s,a)=>(n(),r("div",{key:s.id||a,class:M(["px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 rounded cursor-pointer",{"bg-slate-50":d.value===a}]),onClick:p=>D(s),onMouseenter:p=>d.value=a},[m(y,{tag:"div",weight:"medium"},{default:c(()=>[h(v(s.title),1)]),_:2},1024),s.category?(n(),S(y,{key:0,tag:"div",size:"xs",color:"muted",class:"mt-0.5"},{default:c(()=>[h(v(s.category),1)]),_:2},1024)):f("",!0)],42,pe))),128))])):f("",!0),t.filters&&t.filters.length>0?(n(),r("div",ve,[m(y,{tag:"div",size:"xs",weight:"semibold",color:"muted",class:"px-2 py-1 uppercase mb-2"},{default:c(()=>[...o[1]||(o[1]=[h(" Фильтры ",-1)])]),_:1}),(n(!0),r(C,null,B(t.filters,s=>(n(),r("div",{key:s.id,class:"mb-2"},[m(y,{tag:"label",size:"xs",color:"muted",class:"block mb-1"},{default:c(()=>[h(v(s.label),1)]),_:2},1024),se(H("select",{"onUpdate:modelValue":a=>b.value[s.id]=a,class:"w-full text-sm border border-slate-200 rounded-lg px-2 py-1 focus:outline-none focus:ring-2 focus:ring-slate-900/10",onChange:Q},[(n(!0),r(C,null,B(s.options,a=>(n(),r("option",{key:a,value:a},v(a),9,we))),128))],40,be),[[ne,b.value[s.id]]])]))),128))])):f("",!0)],2)):f("",!0)]),_:1})],8,me))}},Ee=ue(T,[["__scopeId","data-v-83424ed8"]]);T.__docgenInfo={exportName:"default",displayName:"DXSearchBar",description:"",tags:{},props:[{name:"modelValue",description:"Значение поискового запроса (v-model)",type:{name:"string"},defaultValue:{func:!1,value:'""'}},{name:"placeholder",description:"Placeholder",type:{name:"string"},defaultValue:{func:!1,value:'"Поиск..."'}},{name:"label",description:"Лейбл",type:{name:"string"},defaultValue:{func:!1,value:'""'}},{name:"helper",description:"Вспомогательный текст",type:{name:"string"},defaultValue:{func:!1,value:'""'}},{name:"error",description:"Текст ошибки",type:{name:"string"},defaultValue:{func:!1,value:'""'}},{name:"required",description:"Обязательное поле",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"disabled",description:"Отключенное состояние",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"size",description:"Размер: xs | sm | md | lg | xl",type:{name:"string"},defaultValue:{func:!1,value:'"md"'}},{name:"suggestions",description:`Массив предложений для автодополнения
Формат: [{ id, title, category? }]`,type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"loading",description:"Индикация загрузки",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"hotkey",description:'Горячая клавиша (например, "ctrl+k" или "cmd+k")',type:{name:"string"},defaultValue:{func:!1,value:"null"}},{name:"showHistory",description:"Показывать историю поиска",type:{name:"boolean"},defaultValue:{func:!1,value:"false"}},{name:"historyItems",description:"Элементы истории поиска",type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"filters",description:`Фильтры для расширенного поиска
Формат: [{ id, label, options: [] }]`,type:{name:"array"},defaultValue:{func:!1,value:"[]"}},{name:"debounce",description:"Задержка debounce в миллисекундах",type:{name:"number"},defaultValue:{func:!1,value:"300"}},{name:"clearable",description:"Показывать кнопку очистки",type:{name:"boolean"},defaultValue:{func:!1,value:"true"}},{name:"dropdownWidth",description:"Ширина dropdown: sm | md | lg | xl | auto",type:{name:"string"},defaultValue:{func:!1,value:'"auto"'}}],events:[{name:"update:modelValue"},{name:"search"},{name:"select-suggestion"},{name:"filter-change"},{name:"clear"}],sourceFiles:["/Users/lea_alex/Projects/1_DEVELOP/0_DESIGN_X_DEV/dxd-style-code/src/components/molecules/DXSearchBar/DXSearchBar.vue"]};export{Ee as D};
